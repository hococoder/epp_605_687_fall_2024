<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week03/05-SettingUpASchema"/><meta name="twitter:url" content="https://hococoder.com/posts/Week03/05-SettingUpASchema"/><meta name="og:url" content="https://hococoder.com/posts/Week03/05-SettingUpASchema"/><title>Week 3 - Setting up a Schema | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 3 - Setting up a Schema | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 3 - Setting up a Schema | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_spring_2024/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_spring_2024/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_spring_2024/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_spring_2024/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_spring_2024/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_spring_2024/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_spring_2024/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_spring_2024/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_spring_2024/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_spring_2024/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_spring_2024/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_spring_2024/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_spring_2024/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_spring_2024/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_spring_2024/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_spring_2024/posts/Week13/00-Week13Overview">Week13</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 3 - Setting up a Schema</h1><p style="float: left">Previous:  <A HREF="../04-IntroductionToCoreData/index.html">Introduction to Core Data</A></p><p style="float: right">Next:  <A HREF="../06-NSManagedObjects/index.html" class="nextModule">Making NSManagedObjects</A></p><BR/><BR/><h2>Overview</h2><p>If you're familiar with databases at all, you know that there are 3 main components that drive their structure:</p><ul><li>Tables - these represent the types you want to store in the database</li><li>Columns - the columns of the table represent the attributes (properties) of the types (rows are therefore the instances of that type you are storing in the database)</li><li>Relationships - the types in your database may be related to one another: One-To-One, One-To-Many, and Many-To-Many.</li></ul><p>Let's look at how Xcode represents the above components.</p><h2>The <code>xcdatamodeld</code> File</h2><p>The <code>xcdatamodeld</code> file, which comes with the App template when you add Core Data as an option, allows you to setup entities, attributes and relationships for the items in your database. Think of it as your database schema - defining your tables and columns, and the 1 to 1, 1 to many or many to many relationships that may exist between them. You can also make named requests ahead of time. You can even make different database configurations that can all be accessed from your store coordinator.</p><img src="../../../week03/CoreDataSchema.png#centerResizedSlide" alt="The XCDataModeld interface in Xcode"/><h2>Setting up a Schema</h2><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_ixn2as2i?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_ixn2as2i&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p>So given all that, how do you setup a schema to use in your project? First, Xcode uses some terminology that may be a little different from what you are used to - what you would usually refer to as a "database table" is referred to as an "entity".</p><h3>Adding Entities</h3><p>We can use the Add Entity button at the bottom to start a new entity. we’ll call it <code>Teacher</code>, keeping our grade book example going. Initially the entity has a generic name, but we can either use the properties editor to change it, or single click on the entity name to rename it.</p><img src="../../../week03/addEntity.png#centerResized" alt="Add Entity Button"/><h3>Setting Attributes</h3><p>Attributes of the entity are the equivalent of a column in a database table - these are the values we’ll save for each row of the table. There is a button in the lower right hand side of the schema editor to add new attributes:</p><img src="../../../week03/addAttribute.png#centerResized" alt="Add Attribute Button"/><p>You can also add new attributes with the "+" button in the attributes section for the given entity</p><p>We’ll keep it simple here, just adding in an <code>jhed</code> and <code>name</code> attribute. Be sure to set an appropriate type for each of these attributes (both should be <code>String</code>). Let’s create another entity called <code>Assignment</code> that will store the assignment <code>name</code> and <code>dueDate</code> as attributes. Again, be sure to set types for these - <code>String</code> and <code>Date</code> respectively.</p><h3>Attribute Properties</h3><p>Let’s use the properties pane to put some bounds on our <code>dueDate</code> attribute. Let's set the bounds going from today to the end of semester. These constraints aren’t just for show - they get checked when data is stored (or on request) and if a validation fails, errors get thrown.</p><img src="../../../week03/attributeProperties.png#centerResized" alt="Attribute Properties"/><p>There is one property that may have caught your eye - "Optional". This is <strong>not</strong> the same as a Swift optional. This properties dictates whether the attributes is required when persisting the entity to the data store. If this box is checked, the entity does not have to have this property set with a value. The default value for "Optional" is true, but since we want each <code>assignment</code> to have a <code>dueDate</code>, we'll untick that box.</p><p>Before moving on, add one more entity, this time calling it <code>AssignmentGrade</code>, with <code>grade</code> and <code>graderComments</code> attributes.</p><h3>Defining Relationships</h3><p>Now, our assignment isn’t any good unless we know the grades the students received, so we need some way to connect the two. In CoreData this is done by establishing a relationship. Add a new relationship to the <code>AssignmentGrade</code>, and call it assignment, setting the Destination as the <code>Assignment</code>.<br><br><img src="../../../week03/assignmentRelationship.png#centerResizedSlide" alt="Setting a relationship"/></p><p>Do the same in the <code>Assignment</code>, but make a relationship called grades that has an <code>AssignmentGrade</code> destination. Now since we’ve set relationships in both, we can set the inverse for each one - the assignment’s inverse is the <code>assignmentGrade</code>'s relationship and vice versa. In the <code>Assignment</code>'s grades relationship we can do one more thing. An assignment will have many grades (from the various student submissions), so change the relationship from a “To One” to a “To Many” relationship in the Data Model Inspector.</p><p class="info">Apple defines the Inverse for relationships this way: Inverse relationships enable Core Data to propagate change in both directions when an instance of either the source or destination type changes. Every relationship should have an inverse. </p><p>Among the other parameters here, you can also set a Delete Rule that tells the model what to do with the assignments if the student object it is bound to is deleted from the database. In our case, I’ve left it as "nullify" (which removes the relationship between the items), but you can also choose something like "cascade", which will delete the associated assignments when you delete the student that owns them.</p><h3>Defining Fetch Requests and Configurations</h3><p>In addition to entities, you can also add items such as fetch requests and configurations. Configurations can be used to setup multiple persistent stores that are all managed by the same coordinator. Fetch requests can be used to setup predefined fetch statements, or queries, instead of having to worry about writing them in code. We can make a request that gets all of the assignments that have a name that matches “Assignment 1” - that query can then be fetched from the code “pre-canned” and used right away. The model editor in CoreData not only gives you the ability to setup entities, attributes and relationships, but also establish pre canned queries and hooks into different configurations for your database.</p><p>In the next module, we'll talk about how Core Data stores the class types behind the scenes using NSManagedObjects.</p><p style="float: left">Previous:  <A HREF="../04-IntroductionToCoreData/index.html">Introduction to Core Data</A></p><p style="float: right">Next:  <A HREF="../06-NSManagedObjects/index.html" class="nextModule">Making NSManagedObjects</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated January 21, 2024 at 1:48 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>