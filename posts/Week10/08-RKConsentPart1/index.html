<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week10/08-RKConsentPart1"/><meta name="twitter:url" content="https://hococoder.com/posts/Week10/08-RKConsentPart1"/><meta name="og:url" content="https://hococoder.com/posts/Week10/08-RKConsentPart1"/><title>Week 10 - ResearchKit Consent (Part 1) | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 10 - ResearchKit Consent (Part 1) | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 10 - ResearchKit Consent (Part 1) | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_spring_2024/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_spring_2024/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_spring_2024/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_spring_2024/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_spring_2024/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_spring_2024/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_spring_2024/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_spring_2024/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_spring_2024/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_spring_2024/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_spring_2024/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_spring_2024/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_spring_2024/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_spring_2024/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_spring_2024/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_spring_2024/posts/Week13/00-Week13Overview">Week13</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 10 - ResearchKit Consent (Part 1)</h1><p style="float: left">Previous:  <A HREF="../07-IntroductionToResearchKit/index.html">Introduction to ResearchKit</A></p><p style="float: right">Next:  <A HREF="../09-RKConsentPart2/index.html" class="nextModule">ResearchKit Consent Part 2</A></p><BR/><BR/><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_9vvvamb5?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_9vvvamb5&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p class="info">Word of warning here:  You'll need to run things in the simulator here - ResearchKit and the preview canvas don't work well together (there is something wrong when trying to link ResearchKit)</p><p>Let's look at how to get consent from a user in your ResearchKit application. Let’s make a new group in the project called consent, just to help keep files organized. Then, make a new class called ConsentDocument that extends the ORKConsentDocument class. While we’re here, also make a ConsentTask class that extends the ORKOrderedTask class. In each class, import the ResearchKit framework. Now, we’re going to actually change the types in those 2 files from class types to variables. Yes - you can declare a variable in its own file, and in changing the syntax from class to public var, we’ve changed the meaning of the colon. Note that in the example app code, I've consolidated this into one file just to keep things simpler to manage.</p><p>Now, it states that ConsentDocument is of type ORKConsentDocument, instead of ConsentDocument extending ORKConsentDocument. Here, the ConsentDocument is now a computed property - we’re going to define what this property should return on the fly. First, make a consentDocument object with ORKConsentDocument(), and return it so the compiler doesn’t complain. Now let’s configure it to our specifications.</p><ul><li>Set the title to “Consent for My Super Study”, and then declare some consent types. In our fake application here, we’ll be presenting an overview, tell the user how we gather data, and give a privacy statement.</li><li>Next, create a content sections array by mapping over the content section types. That means for each of the types, do the following: define a content section, passing in the content type, declare a summary and content (which for this example are the same for every type, you’ll want to do something different) and return the section.</li><li>Set the sections property of the consentDocument we are building to the contentSections array we just made.</li><li>Finally add a signature section to our consent document. This lets the user sign with their finger to show they consent to the terms we’ve laid out here.</li><li>At the end of the block we have the return statement that we set before, so we’re all set.</li></ul><pre><code><span class="keyword">public var</span> <span class="type">ConsentDocument</span>: <span class="type">ORKConsentDocument</span>
{
  <span class="keyword">let</span> consentDocument = <span class="type">ORKConsentDocument</span>()
  consentDocument.<span class="property">title</span> = <span class="string">"Your title here!"</span>
  
  <span class="keyword">let</span> consentSectionTypes: [<span class="type">ORKConsentSectionType</span>] = [
    .<span class="dotAccess">overview</span>,
    .<span class="dotAccess">dataGathering</span>,
    .<span class="dotAccess">privacy</span>
    <span class="comment">//others?!</span>
  ]
  
  <span class="keyword">let</span> consentSections: [<span class="type">ORKConsentSection</span>] = consentSectionTypes.<span class="call">map</span> { contentSectionType <span class="keyword">in
    let</span> consentSection = <span class="type">ORKConsentSection</span>(type: contentSectionType)
    consentSection.<span class="property">summary</span> = <span class="string">"Put a summary here!"</span>
    consentSection.<span class="property">content</span> = <span class="string">"Put a Content description here!"</span>
    <span class="keyword">return</span> consentSection
  }
  
  consentDocument.<span class="property">sections</span> = consentSections
  
  consentDocument.<span class="call">addSignature</span>(<span class="type">ORKConsentSignature</span>(forPersonWithTitle: <span class="keyword">nil</span>, dateFormatString: <span class="keyword">nil</span>, identifier: <span class="string">"ConsentDocumentParticipantSignature"</span>))
  
  <span class="keyword">return</span> consentDocument
}
</code></pre><p>Now we’re going to do the same conversion to the ConsentTask file and define that property as a computed property as well. The consent task will consist of a series of ORKSteps, which we’ll initialize an array of.</p><ul><li>Set a consent document object to our ConsentDocument property we made earlier.</li><li>Then make a ORKVisualConsentStep object, which takes in a VisualConsentStep identifier string and our consentDocument.</li><li>Add that visualConsentStep object to our steps array.</li><li>Then get the first object from the consentDocument’s signatures array, and make a ORKConsentReviewStep that takes in that signature object and our consentDocument object.</li><li>Set the text of that review step, as well as a reason for consent to present to the user. Add that step to the array as well.</li><li>Finally, return a ORKOrderedTask object that contains our steps array, and has the “ConsentTask” identifier.</li></ul><pre><code><span class="keyword">public var</span> <span class="type">ConsentTask</span>: <span class="type">ORKOrderedTask</span>
{
  <span class="keyword">var</span> steps = [<span class="type">ORKStep</span>]()
  
  <span class="keyword">let</span> consentDocument = <span class="type">ConsentDocument</span>
  <span class="keyword">let</span> visualConsentStep = <span class="type">ORKVisualConsentStep</span>(identifier: <span class="string">"VisualConsentStep"</span>, document: consentDocument)
  steps += [visualConsentStep]
  
  <span class="keyword">let</span> signature = consentDocument.<span class="property">signatures</span>!.first
  <span class="keyword">let</span> reviewConsentStep = <span class="type">ORKConsentReviewStep</span>(identifier: <span class="string">"ConsentReviewStep"</span>, signature: signature, in: consentDocument)
  
  reviewConsentStep.<span class="property">text</span> = <span class="string">"Review Consent!"</span>
  reviewConsentStep.<span class="property">reasonForConsent</span> = <span class="string">"Consent to join study"</span>
  
  steps += [reviewConsentStep]
  
  <span class="keyword">return</span> <span class="type">ORKOrderedTask</span>(identifier: <span class="string">"ConsentTask"</span>, steps: steps)
}
</code></pre><p>If you have any questions about the examples in this video, please post them in the forums.</p><p style="float: left">Previous:  <A HREF="../07-IntroductionToResearchKit/index.html">Introduction to ResearchKit</A></p><p style="float: right">Next:  <A HREF="../09-RKConsentPart2/index.html" class="nextModule">ResearchKit Consent Part 2</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated January 21, 2024 at 1:48 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>