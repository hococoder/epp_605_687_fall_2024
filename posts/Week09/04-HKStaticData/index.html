<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Mobile Application Development for the iOS Platform"/><link rel="canonical" href="https://hococoder.com/posts/Week09/04-HKStaticData"/><meta name="twitter:url" content="https://hococoder.com/posts/Week09/04-HKStaticData"/><meta name="og:url" content="https://hococoder.com/posts/Week09/04-HKStaticData"/><title>Week 9 - HealthKit Static Data | Mobile Application Development for the iOS Platform</title><meta name="twitter:title" content="Week 9 - HealthKit Static Data | Mobile Application Development for the iOS Platform"/><meta name="og:title" content="Week 9 - HealthKit Static Data | Mobile Application Development for the iOS Platform"/><meta name="description" content="A description of my first post."/><meta name="twitter:description" content="A description of my first post."/><meta name="og:description" content="A description of my first post."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="../../../styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Mobile Application Development for the iOS Platform"/></head><body><header><div class="wrapper"><a class="site-name" href="/">Mobile Application Development for the iOS Platform</a><nav><ul><li><a href="/epp_605_687_spring_2024/posts/Intro/About Me">AboutMe</a></li><li><a href="/epp_605_687_spring_2024/posts/Intro/Example App">ExampleApp</a></li><li><a href="/epp_605_687_spring_2024/posts/Week00/00-Week00Overview">Week0</a></li><li><a href="/epp_605_687_spring_2024/posts/Week01/00-Week01Overview">Week1</a></li><li><a href="/epp_605_687_spring_2024/posts/Week02/00-Week02Overview">Week2</a></li><li><a href="/epp_605_687_spring_2024/posts/Week03/00-Week03Overview">Week3</a></li><li><a href="/epp_605_687_spring_2024/posts/Week04/00-Week04Overview">Week4</a></li><li><a href="/epp_605_687_spring_2024/posts/Week05/00-Week05Overview">Week5</a></li><li><a href="/epp_605_687_spring_2024/posts/Week06/00-Week06Overview">Week6</a></li><li><a href="/epp_605_687_spring_2024/posts/Week07/00-Week07Overview">Week7</a></li><li><a href="/epp_605_687_spring_2024/posts/Week08/00-Week08Overview">Week8</a></li><li><a href="/epp_605_687_spring_2024/posts/Week09/00-Week09Overview">Week9</a></li><li><a href="/epp_605_687_spring_2024/posts/Week10/00-Week10Overview">Week10</a></li><li><a href="/epp_605_687_spring_2024/posts/Week11/00-Week11Overview">Week11</a></li><li><a href="/epp_605_687_spring_2024/posts/Week12/00-Week12Overview">Week12</a></li><li><a href="/epp_605_687_spring_2024/posts/Week13/00-Week13Overview">Week13</a></li></ul></nav></div></header><div class="wrapper"><h1>Week 9 - HealthKit Static Data</h1><p style="float: left">Previous:  <A HREF="../03-HKAccess/index.html">Getting HealthKit Access</A></p><p style="float: right">Next:  <A HREF="../05-HKQueries/index.html" class="nextModule">HealthKit Queries</A></p><BR/><BR/><h2>Example - Accessing Static Data</h2><center> <iframe width="1280" height="720" src="https://cdnapisec.kaltura.com/html5/html5lib/v2.81.2/mwEmbedFrame.php/p/1458241/uiconf_id/14487351/entry_id/1_tzzlb9g2?wid=_1458241&iframeembed=true&playerId=kaltura_player&entry_id=1_tzzlb9g2&flashvars[localizationCode]=en&amp;flashvars[leadWithHTML5]=true&amp;flashvars[sideBarContainer.plugin]=true&amp;flashvars[sideBarContainer.position]=left&amp;flashvars[sideBarContainer.clickToClose]=true&amp;flashvars[chapters.plugin]=true&amp;flashvars[chapters.layout]=vertical&amp;flashvars[chapters.thumbnailRotator]=false&amp;flashvars[streamSelector.plugin]=true&amp;flashvars[EmbedPlayer.SpinnerTarget]=videoHolder&amp;flashvars[dualScreen.plugin]=true&amp;flashvars[mediaProxy.preferedFlavorBR]=2500&amp;flashvars[Kaltura.addCrossoriginToIframe]=true&amp;flashvars[EmbedPlayer.NotPlayableDownloadLink]=true;&wid=1_abkvs1gz"allowfullscreen webkitallowfullscreen mozAllowFullScreen allow="autoplay *; fullscreen *; encrypted-media *" sandbox="allow-forms allow-same-origin allow-scripts allow-top-navigation allow-pointer-lock allow-popups allow-modals allow-orientation-lock allow-popups-to-escape-sandbox allow-presentation allow-top-navigation-by-user-activation" frameborder="0" title="Kaltura Player">
  </iframe>
</center><p>There are several different ways to access the different types of data in HealthKit, so let's build a class that contains some methods to help us get that data. The simplest type of data we can get are things like date of birth and other items that don't typically change from day to day. Make a <code>HealthKitDataHelper</code> class that adopts <code>ObservableObject</code> and make the <code>birthdayDate</code> a <code>@Published</code> property:</p><pre><code><span class="keyword">class</span> HealthKitDataHelper: <span class="type">NSObject</span>, <span class="type">ObservableObject</span> {

  <span class="keyword">@Published var</span> birthdayDate: <span class="type">Date</span> = <span class="type">Date</span>()

</code></pre><p>Then make a <code>loadData</code> method that we'll use to load our various data types</p><pre><code><span class="keyword">func</span> loadData() {
  
  <span class="call">readBirthDay</span>()
}
</code></pre><p>And then define the <code>readBirthDay</code> function:</p><pre><code><span class="comment">//Simple query of "basic" data</span>
<span class="keyword">func</span> readBirthDay()
{
  <span class="keyword">let</span> healthKitStore = <span class="type">HKHealthStore</span>()
  <span class="keyword">let</span> birthday = <span class="keyword">try</span>! healthKitStore.<span class="call">dateOfBirthComponents</span>()
  
  <span class="comment">//Perform update the state on the main thread</span>
  <span class="type">DispatchQueue</span>.<span class="property">main</span>.<span class="call">async</span> {
    <span class="keyword">self</span>.<span class="property">birthdayDate</span> = <span class="type">Calendar</span>.<span class="property">current</span>.<span class="call">date</span>(from: birthday)!
  }
}
</code></pre><p>In this function, we get an instance of the <code>HKHealthStore</code>, and attempt to get the <code>dateOfBirthComponents</code>. Since I'm sure I've already loaded in a DOB in the simulator's Health profile, I use <code>try!</code> here, but you should really use <code>try?</code> and check for and handle errors. If you get a valid birthday, set the <code>birthdayDate</code> property, and make sure to do it on the main queue, since this will be causing an update of the UI, which we'll define next.</p><p>Back in the <code>HealthKitView</code>'s body's else block, replace the Text placeholder we had with the following:</p><pre><code><span class="type">Form</span> {
  <span class="type">HStack</span> {
    <span class="type">Text</span>(<span class="string">"Birthday"</span>)
    <span class="type">Spacer</span>()
    <span class="type">Text</span>(dateFormatter.<span class="call">string</span>(from: hkData.<span class="property">birthdayDate</span>))
  }
}
</code></pre><p>This simply displays the date formatted birthday along with a label in a nicely formatted <code>Form</code> view.</p><p>Make sure that the end of the Button's action handler includes a call to <code>loadData</code> in the <code>hkData</code> object, so the data will get loaded:</p><pre><code><span class="call">print</span>(<span class="string">"HealthKit Successfully Authorized."</span>)
<span class="keyword">self</span>.<span class="property">hkData</span>.<span class="call">loadData</span>()
<span class="type">UserDefaults</span>.<span class="property">standard</span>.<span class="call">set</span>(<span class="keyword">true</span>, forKey: <span class="string">"hkAuthorized"</span>)
<span class="keyword">self</span>.<span class="property">hkEnabled</span>.<span class="call">toggle</span>()
</code></pre><p>Let's run that in the simulator. Note that the view showing the "Authorize HealthKit" button doesn't show, since we've already authorized it and saved that state in the <code>UserDefaults</code>, instead bringing us right into the main view. The birthday is shown in the view as expected.</p><p>Reading basic data is pretty straight forward - but what if we wanted to read historical data like weight? Checkout the next video for an example.<br><br>If you have any questions about the examples in this video, please post them in the forums.</p><p style="float: left">Previous:  <A HREF="../03-HKAccess/index.html">Getting HealthKit Access</A></p><p style="float: right">Next:  <A HREF="../05-HKQueries/index.html" class="nextModule">HealthKit Queries</A></p></div><footer><p>Generated with ❤️ using <a href="https://github.com/johnsundell/publish">Publish</a></p><p>© 2023-2024 Josh Steele (rsteele3@jhu.edu) <a href="mailto:"(rsteele3@jhu.edu)""></a></p><p>Last updated January 21, 2024 at 1:48 PM</p><p><a href="https://mastodon.social/@hococoder" target="_blank">My Mastodon</a> | <a href="https://github.com/hococoder" target="_blank">My GitHub</a> | <a href="https://ep.jhu.edu" target="_blank">Whiting School EPP</a> | <a href="https://canvas.jhu.edu" target="_blank">JHU Canvas</a></p></footer></body></html>